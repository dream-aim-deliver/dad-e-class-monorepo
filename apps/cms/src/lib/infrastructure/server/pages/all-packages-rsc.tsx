// Auto-generated by page-scaffold command
// Notion: https://www.notion.so/CMS-All-Packages-Manage-Packages-13a5a7432d01809c9917d80fe8f7b644
// Usecases: listPackages (FEAT-164), archivePackage (FEAT-165)
// User Type: CMS

import AllPackages from '../../client/pages/all-packages';
import { Suspense } from 'react';
import DefaultLoadingWrapper from '../../client/wrappers/default-loading';
import { HydrateClient, prefetch, getServerTRPC } from '../config/trpc/cms-server';
import { TLocale } from '@maany_shr/e-class-translations';

interface AllPackagesProps {
  locale: TLocale;
  platformSlug: string;
  platformLocale: string;
}

export default async function AllPackagesServerComponent(props: AllPackagesProps) {
  const trpc = getServerTRPC({
    platform_slug: props.platformSlug,
    platform_locale: props.platformLocale,
  });

  await Promise.all([
    prefetch(trpc.listPackages.queryOptions({
      platformSlug: props.platformSlug,
      platformLocale: props.platformLocale
    })),
  ]);

  return (
    <HydrateClient>
      <Suspense fallback={<DefaultLoadingWrapper />}>
        <AllPackages
          locale={props.locale}
          platformSlug={props.platformSlug}
          platformLocale={props.platformLocale}
        />
      </Suspense>
    </HydrateClient>
  );
}
