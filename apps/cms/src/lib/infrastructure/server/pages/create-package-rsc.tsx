// Auto-generated by page-scaffold command
// Notion: https://www.notion.so/CMS-Create-package-Manage-Packages-f3ea8a52ac704207bdfdec2bacfb37a1
// Title: CMS Create package (Manage Packages)
// Route: /[platform_slug]/packages/create
// User Types: CMS
// Figma: https://www.figma.com/design/8KEwRuOoD5IgxTtFAtLlyS/Just_Do_Ad-1.2?node-id=6385-175063
// Features: 3 features linked (see Notion)
// UI Components: 9 components linked (see Notion)
// Comments: createPackage creates package in published state

import CreatePackage from '../../client/pages/create-package';
import { Suspense } from 'react';
import DefaultLoadingWrapper from '../../client/wrappers/default-loading';
import { HydrateClient, prefetch, getServerTRPC } from '../config/trpc/cms-server';

interface CreatePackageServerComponentProps {
    platformSlug: string;
    platformLocale: string;
    locale: string;
}

export default async function CreatePackageServerComponent(
    props: CreatePackageServerComponentProps,
) {

    const trpc = getServerTRPC({
        platform_slug: props.platformSlug,
        platform_locale: props.platformLocale,
    });

    // Streaming pattern: Fire prefetches without awaiting (TSK-PERF-007)
    // React will stream HTML while queries are pending
    prefetch(trpc.getPlatformLanguage.queryOptions({}));
    prefetch(trpc.listCourses.queryOptions({ showFilter: "live_all_languages" }));

    return (
        <HydrateClient>
            <Suspense fallback={<DefaultLoadingWrapper />}>
                <CreatePackage/>
            </Suspense>
        </HydrateClient>
    );
}
