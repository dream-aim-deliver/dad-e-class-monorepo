// Auto-generated by page-scaffold command v2
// Notion: https://www.notion.so/CMS-Manage-Offers-Page-22d5a7432d01809487b5f5592b2013f3
// Usecases: saveOffersPage, listPackages, requestFileUpload, getOffersPageOutline, listOffersPagePackagesShort
// User Types: CMS (admin/superadmin)
// Figma: https://www.figma.com/design/8KEwRuOoD5IgxTtFAtLlyS/Just_Do_Ad-1.2?node-id=8540-240257&t=qGirq2t6ka6iwg1A-4

import { HydrateClient, prefetch, getServerTRPC } from '../config/trpc/cms-server';
import { Suspense } from 'react';
import DefaultLoadingWrapper from '../../client/wrappers/default-loading';
import ManageOffersPage from '../../client/pages/manage-offers-page';

interface ManageOffersPageServerComponentProps {
    locale: string;
    platformSlug: string;
    platformLocale: string;
}

export default async function ManageOffersPageServerComponent({
    locale,
    platformSlug,
    platformLocale,
}: ManageOffersPageServerComponentProps) {
    // Get platform-aware TRPC proxy
    const trpc = getServerTRPC({
        platform_slug: platformSlug,
        platform_locale: platformLocale
    });

    // TRPC prefetching for page data using EXACT usecase names from Notion
    // Authentication is handled by middleware - only admin/superadmin can access
    await Promise.all([
        prefetch(trpc.getOffersPageOutline.queryOptions({})), // getOffersPageOutline
        prefetch(trpc.listOffersPagePackagesShort.queryOptions({})), // listOffersPagePackagesShort
    ]);

    return (
        <HydrateClient>
            <Suspense fallback={<DefaultLoadingWrapper />}>
                <ManageOffersPage
                    locale={locale}
                    platformSlug={platformSlug}
                    platformLocale={platformLocale}
                />
            </Suspense>
        </HydrateClient>
    );
}
